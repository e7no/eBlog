<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>基于Centos部署Docker环境</title>
      <link href="/2017/03/02/%E5%9F%BA%E4%BA%8ECentos%E9%83%A8%E7%BD%B2Docker%E7%8E%AF%E5%A2%83/"/>
      <content type="html"><![CDATA[<h4 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos:6.8</span><br></pre></td></tr></table></figure><h4 id="将这个镜像启动成为一个容器-并映射端口"><a href="#将这个镜像启动成为一个容器-并映射端口" class="headerlink" title="将这个镜像启动成为一个容器,并映射端口"></a>将这个镜像启动成为一个容器,并映射端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -d --name www -p 33060:3306 -p 220:22 -p 8080:80 centos：6.8 /bin/bash</span><br></pre></td></tr></table></figure><h4 id="查看创建的镜像"><a href="#查看创建的镜像" class="headerlink" title="查看创建的镜像"></a>查看创建的镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><h4 id="进入创建的镜像容器"><a href="#进入创建的镜像容器" class="headerlink" title="进入创建的镜像容器"></a>进入创建的镜像容器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it &lt;container ID&gt; bash</span><br></pre></td></tr></table></figure><h4 id="安装ifconfig"><a href="#安装ifconfig" class="headerlink" title="安装ifconfig"></a>安装ifconfig</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install net-tools –y</span><br></pre></td></tr></table></figure><h4 id="安装ssh服务"><a href="#安装ssh服务" class="headerlink" title="安装ssh服务"></a>安装ssh服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install openssh*</span><br></pre></td></tr></table></figure><h4 id="安装压缩解压缩"><a href="#安装压缩解压缩" class="headerlink" title="安装压缩解压缩"></a>安装压缩解压缩</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y unzip zip</span><br></pre></td></tr></table></figure><h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd</span><br></pre></td></tr></table></figure><h4 id="创建SSH服务目录"><a href="#创建SSH服务目录" class="headerlink" title="创建SSH服务目录"></a>创建SSH服务目录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/run/sshd</span><br></pre></td></tr></table></figure><h4 id="设置秘钥"><a href="#设置秘钥" class="headerlink" title="设置秘钥"></a>设置秘钥</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key</span><br><span class="line">ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</span><br></pre></td></tr></table></figure><h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/sshd -D &amp;</span><br></pre></td></tr></table></figure><h4 id="查看SSH监听端口使用情况"><a href="#查看SSH监听端口使用情况" class="headerlink" title="查看SSH监听端口使用情况"></a>查看SSH监听端口使用情况</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -tunlp</span><br></pre></td></tr></table></figure><h4 id="取消pam登录限制"><a href="#取消pam登录限制" class="headerlink" title="取消pam登录限制"></a>取消pam登录限制</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -ri &apos;s/session required pam_loginuid.so/#session required pam_loginuid.so/g&apos; /etc/pam.d/ssh</span><br></pre></td></tr></table></figure><h4 id="本地创建公钥（非docker环境）-已有则不需要创建"><a href="#本地创建公钥（非docker环境）-已有则不需要创建" class="headerlink" title="本地创建公钥（非docker环境）,已有则不需要创建"></a>本地创建公钥（非docker环境）,已有则不需要创建</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><h4 id="创建授权目录"><a href="#创建授权目录" class="headerlink" title="创建授权目录"></a>创建授权目录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir root/.ssh</span><br></pre></td></tr></table></figure><h4 id="编辑授权文件-复制本地-ssh目录中的id-rsa-pub里面的密钥到授权文件中"><a href="#编辑授权文件-复制本地-ssh目录中的id-rsa-pub里面的密钥到授权文件中" class="headerlink" title="编辑授权文件,复制本地.ssh目录中的id_rsa.pub里面的密钥到授权文件中"></a>编辑授权文件,复制本地.ssh目录中的id_rsa.pub里面的密钥到授权文件中</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><h4 id="创建自动启动SSH服务器的可执行文件run-sh-并添加可执行权限"><a href="#创建自动启动SSH服务器的可执行文件run-sh-并添加可执行权限" class="headerlink" title="创建自动启动SSH服务器的可执行文件run.sh,并添加可执行权限"></a>创建自动启动SSH服务器的可执行文件run.sh,并添加可执行权限</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /run.sh</span><br><span class="line">chmod +x run.sh</span><br></pre></td></tr></table></figure><h4 id="编辑run-sh"><a href="#编辑run-sh" class="headerlink" title="编辑run.sh"></a>编辑run.sh</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">/usr/sbin/sshd -D</span><br></pre></td></tr></table></figure><h4 id="通过Xshell登录该镜像-地址为docker的IP，端口号为220-账号为：root-密码为上面设置的密码"><a href="#通过Xshell登录该镜像-地址为docker的IP，端口号为220-账号为：root-密码为上面设置的密码" class="headerlink" title="通过Xshell登录该镜像,地址为docker的IP，端口号为220,账号为：root,密码为上面设置的密码"></a>通过Xshell登录该镜像,地址为docker的IP，端口号为220,账号为：root,密码为上面设置的密码</h4><hr>]]></content>
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> centos </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
